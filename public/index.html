<!DOCTYPE html>
<html lang="it">
<head>
<meta charset="UTF-8">
<title>Gestionale RP</title>
<link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet">
<style>
  /* --- BODY --- */
  body {
    margin:0;
    font-family: 'Roboto', sans-serif;
    background: linear-gradient(135deg,#0f172a,#1e293b);
    display:flex;
    justify-content:center;
    align-items:center;
    height:100vh;
    overflow:hidden;
    color:white;
  }

  /* --- CARD CENTRALE --- */
  .card-container {
    background: rgba(30,41,59,0.95);
    padding:50px 40px;
    border-radius:20px;
    box-shadow: 0 0 30px rgba(0,0,0,0.5);
    text-align:center;
    width:350px;
    animation: fadeSlide 1s ease forwards;
  }

  /* --- TITOLO --- */
  h1 {
    font-size:2.5em;
    margin-bottom:20px;
  }

  p {
    font-size:1em;
    color:#cbd5e1;
  }

  /* --- PULSANTI --- */
  .btn {
    background-color:#2563eb;
    border:none;
    border-radius:12px;
    padding:15px 30px;
    font-size:1.2em;
    color:white;
    cursor:pointer;
    transition: all 0.3s ease;
    margin-top:20px;
  }

  .btn:hover {
    background-color:#1d4ed8;
    transform: scale(1.05);
    box-shadow: 0 0 15px #2563eb;
  }

  /* --- LOGIN & REGISTRAZIONE --- */
  .form-box {
    margin-top:30px;
    display:none;
    text-align:left;
  }

  .form-box input {
    width:100%;
    padding:12px;
    margin-bottom:15px;
    border-radius:8px;
    border:none;
    font-size:1em;
  }

  .link-switch {
    color:#2563eb;
    cursor:pointer;
    text-decoration:underline;
    font-size:0.95em;
  }

  /* --- DASHBOARD --- */
  .dashboard {
    display:none;
    text-align:center;
  }

  .dashboard .card {
    background:#1e293b;
    padding:25px;
    border-radius:12px;
    margin-top:20px;
    font-size:1.2em;
  }

  /* --- ANIMAZIONI --- */
  @keyframes fadeSlide {
    from{opacity:0; transform:translateY(30px);}
    to{opacity:1; transform:translateY(0);}
  }

</style>
</head>
<body>

<!-- CARD CENTRALE -->
<div class="card-container" id="welcomeCard">
  <h1>Benvenuto</h1>
  <p>Accedi per consultare il tuo account e gestire il tuo personaggio.</p>
  <button class="btn" id="connectBtn">Collega account</button>

  <!-- LOGIN -->
  <div class="form-box" id="loginBox">
    <h3>Login</h3>
    <form id="loginForm">
      <input type="text" name="nickname" placeholder="Nickname" required>
      <input type="password" name="password" placeholder="Password" required>
      <button class="btn" type="submit">Accedi</button>
    </form>
    <p>Non hai un account? <span class="link-switch" id="showRegister">Registrati</span></p>
  </div>

  <!-- REGISTRAZIONE -->
  <div class="form-box" id="registerBox">
    <h3>Registrazione</h3>
    <form id="registerForm">
      <input type="text" name="nome" placeholder="Nome" required>
      <input type="text" name="cognome" placeholder="Cognome" required>
      <input type="text" name="nickingame" placeholder="Nickingame" required>
      <input type="text" name="username" placeholder="Username per il server" required>
      <input type="password" name="password" placeholder="Password" required>
      <button class="btn" type="submit">Registrati</button>
    </form>
    <p>Hai gi√† un account? <span class="link-switch" id="showLogin">Login</span></p>
  </div>
</div>

<!-- DASHBOARD MINIMA -->
<div class="dashboard" id="dashboard">
  <div class="card">
    <h2 id="nickname">Nickname: ---</h2>
    <p id="balance">Balance: $0,0</p>
  </div>
</div>

<script>
const connectBtn = document.getElementById('connectBtn');
const loginBox = document.getElementById('loginBox');
const registerBox = document.getElementById('registerBox');
const welcomeCard = document.getElementById('welcomeCard');
const dashboard = document.getElementById('dashboard');
const nicknameField = document.getElementById('nickname');
const balanceField = document.getElementById('balance');

connectBtn.addEventListener('click', ()=>{
  loginBox.style.display='block';
  connectBtn.style.display='none';
});

// Switch tra login e registrazione
document.getElementById('showRegister').addEventListener('click', ()=>{
  loginBox.style.display='none';
  registerBox.style.display='block';
});
document.getElementById('showLogin').addEventListener('click', ()=>{
  registerBox.style.display='none';
  loginBox.style.display='block';
});

// LOGIN
document.getElementById('loginForm').addEventListener('submit', async function(e){
  e.preventDefault();
  const nickname = this.nickname.value;
  const password = this.password.value;

  const res = await fetch('/login',{
    method:'POST',
    headers:{'Content-Type':'application/json'},
    body:JSON.stringify({nickname,password})
  });

  const text = await res.text();
  if(text.includes("Utente non trovato") || text.includes("Password errata")){
    alert(text);
    return;
  }

  // Mostra dashboard minima
  welcomeCard.style.display='none';
  dashboard.style.display='block';
  nicknameField.textContent="Nickname: "+nickname;
  balanceField.textContent="Balance: $0,0";
});

// REGISTRAZIONE (solo frontend per ora)
document.getElementById('registerForm').addEventListener('submit', function(e){
  e.preventDefault();
  alert('Registrazione completata! Ora puoi fare login.');
  registerBox.style.display='none';
  loginBox.style.display='block';
});
</script>

</body>
</html>
